<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Get Started</title>
</head>
    <body>
      <div>
        <select id="floor">
          <option value="ground">Ground Floor</option>
          <option value="first">First Floor</option>
          <option value="second">Second Floor</option>
        </select><br><br>
        <select id="type">
          <option value="cabin">Cabin</option>
          <option value="enclosure">Enclosure</option>
          <option value="workstation">Workstation</option>
        </select><br><br>
        <input type="number" id="number" placeholder="Seat Number"><br><br>
        <input type="text" id="name" placeholder="Name"><br><br>
        <input type="text" id="designation" placeholder="Designation"><br><br>
      </div>
      <button id="submit">Submit</button>

      <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.5.0/firebase-app.js";
        import { getDatabase, ref, set, get, child, update, remove } from "https://www.gstatic.com/firebasejs/9.5.0/firebase-database.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyA3AV8P1T3gqimzQcg_WZPRSu5Nve_uOEE",
          authDomain: "seatingarrangement-51083.firebaseapp.com",
          databaseURL: "https://seatingarrangement-51083-default-rtdb.firebaseio.com",
          projectId: "seatingarrangement-51083",
          storageBucket: "seatingarrangement-51083.appspot.com",
          messagingSenderId: "647959728113",
          appId: "1:647959728113:web:4f1d06a59b0b76bff37e50",
          measurementId: "G-84ENMPFN1F"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase();

        var nam = document.getElementById("name");
        var designation = document.getElementById("designation");
        var floor = document.getElementById("floor");
        var type = document.getElementById("type");
        var number = document.getElementById("number");
        
        var seatNumber;
        var button = document.getElementById("submit");

        function GetSeat(f,t,n){
          var seat = null;

        switch (f)
        {
            case "Ground Floor":
                seat = "G";
                break;
            case "First Floor":
                seat = "F";
                break;
            case "Second Floor":
                seat = "S";
                break;
        }

        switch (t)
        {
            case "Cabin":
                seat += "C";
                break;
            case "Enclosure":
                seat += "E";
                break;
            case "Workstation":
                seat += "W";
                break;
        }
        return seat + n;
        }
  
        function CheckData(){
          seatNumber = GetSeat(floor.options[floor.selectedIndex].text, type.options[type.selectedIndex].text, number.value);
          const dbref = ref(db);
          get(child(dbref, "SeatNumber/"+seatNumber)).then((snapshot)=>{
            if(snapshot.exists()){
              alert("Seat Taken");   
            }
            else{
              SaveData();
            }
          })
          .catch((error)=>{
            console.log(error);
          });
        }

        function SaveData(){
         seatNumber = GetSeat(floor.options[floor.selectedIndex].text, type.options[type.selectedIndex].text, number.value);
          set(ref(db, "SeatNumber/"+seatNumber),{
            name:nam.value,
            designation:designation.value,
            floor:floor.options[floor.selectedIndex].text,
            seatNumber:seatNumber
          })
          .then(()=>{
            alert("Data Successfully uploaded");
          })
          .catch((error)=>{
            console.log(error);
          })
        }

        button.addEventListener('click',CheckData);
     </script>
    </body>
    
</html>